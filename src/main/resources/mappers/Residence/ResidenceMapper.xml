<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.springbootfinal.app.mapper.residence.ResidenceMapper">
    <!-- 숙소 목록 조회 -->
    <select id="getResidences" resultMap="residenceResultMap">
        SELECT * FROM Residence WHERE residName LIKE #{keyword} LIMIT #{offset}, 10
    </select>

    <!-- 숙소 상세 조회 -->
    <select id="getResidenceById" resultMap="residenceResultMap">
        SELECT * FROM Residence WHERE residNo = #{residNo}
    </select>

    <!-- 숙소 정보에 해당하는 사진 정보 조회 -->
    <select id="getPropertyPhotosByResidNo" resultMap="propertyPhotosResultMap">
        SELECT * FROM PropertyPhotos WHERE residNo = #{residNo}
    </select>

    <resultMap id="residenceResultMap" type="com.springbootfinal.app.domain.residence.ResidenceDto">
        <id property="residNo" column="residNo"/>
        <result property="residName" column="residName"/>
        <!-- Other Residence fields -->
        <collection property="propertyPhotos" ofType="com.springbootfinal.app.domain.residence.PropertyPhotosDto">
            <id property="photoNo" column="photoNo"/>
            <result property="photoUrl01" column="photoUrl01"/>
            <!-- Other PropertyPhotos fields -->
        </collection>
    </resultMap>

    <resultMap id="propertyPhotosResultMap" type="com.springbootfinal.app.domain.residence.PropertyPhotosDto">
        <id property="photoNo" column="photoNo"/>
        <result property="photoUrl01" column="photoUrl01"/>
        <!-- Other PropertyPhotos fields -->
    </resultMap>
</mapper>
