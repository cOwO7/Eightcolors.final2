<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/layouts/main_layout}">
<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <meta charset="UTF-8">
  <title>숙소 목록</title>
  <style>
  </style>
</head>
<body>
<th:block layout:fragment="content">
  <div class="container">
    <h1 class="my-4 text-center">숙소 목록</h1>
    <!-- 검색 폼 -->
    <form action="#" th:action="@{/residence/list}" method="get" class="row mb-3">
      <div class="col-3">
        <input type="text" name="keyword" class="form-control" placeholder="검색어를 입력하세요" />
      </div>
      <div class="col-2">
        <button type="submit" class="btn btn-primary">검색</button>
      </div>
    </form>

    <!--<div th:if="${#lists.isEmpty(residences)}">
      <p>No Data Available</p>
    </div>-->
    <!-- 관리자 또는 trader(상인)만 글쓰기 버튼이 보임 -->
    <!--<div class="justify-content-end">
      <input type="button" class="btn btn-primary" value="글쓰기"
             th:if="${#authentication.principal.role == 'ADMIN' or #authentication.principal.role == 'TRADER'}">
    </div>-->
    <!--<table class="table table-bordered">
      <thead>
      <tr>
        <th>번호</th>
        <th>숙소 사진</th>
        <th>제목</th>
        <th>숙소 유형</th>
        <th>체크인</th>
        <th>체크아웃</th>
        <th>가격</th>
        <th>평점</th>
        <th>등록일</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="residence : ${residences}">
        <td th:text="${residence.residNo != null ? residence.residNo : 'No Data'}"></td>
        &lt;!&ndash;<td>
          <img th:src="${propertyPhotos.photoUrl}" alt="숙소 사진" class="img-fluid"/>
        </td>&ndash;&gt;
        <td th:text="${residence.propertyPhotos != null ? residence.propertyPhotos : 'No Data'}"></td>
        <td th:text="${residence.residName != null ? residence.residName : 'No Data'}"></td>
        <td th:text="${residence.residType != null ? residence.residType : 'No Data'}"></td>
        <td th:text="${residence.checkinDate != null ? residence.checkinDate : 'No Data'}"></td>
        <td th:text="${residence.checkoutDate != null ? residence.checkoutDate : 'No Data'}"></td>
        <td th:text="${residence.totalPrice != null ? residence.totalPrice : 'No Data'}"></td>
        <td th:text="${residence.rating != null ? residence.rating : 'No Data'}"></td>
        <td th:text="${residence.residDate != null ? residence.residDate : 'No Data'}"></td>
        <td>
          <a th:href="@{/residence/{residNo}(residNo=${residence.residNo})}" class="btn btn-primary">상세보기</a>
        </td>
      </tr>
      </tbody>
    </table>-->
    <!-- 숙소 목록 테이블 -->
    <table class="table table-bordered">
      <thead>
      <tr>
        <th>번호</th>
        <th>숙소 사진</th>
        <th>숙소 이름</th>
        <th>숙소 유형</th>
        <th>원가</th>
        <th>할인%</th>
        <th>할인 가격</th>
        <th>체크인</th>
        <th>체크아웃</th>
        <th>등록일</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="residence : ${residences}">
        <!-- 숙소 번호 -->
        <td th:text="${residence.residNo}"></td>
        <!-- 숙소 사진 -->
        <th:block th:if="${residence.propertyPhotos != null and not #lists.isEmpty(residence.propertyPhotos)}">
          <td><img th:src="@{|/resources/files/${residence.propertyPhotos[0]}|}" alt="숙소 사진" class="img-fluid"/></td>
        </th:block>
        <th:block th:unless="${residence.propertyPhotos != null and not #lists.isEmpty(residence.propertyPhotos)}">
          <td>사진 없음</td>
        </th:block>
        <!-- 숙소 이름 -->
        <td th:text="${residence.residName}"></td>
        <!-- 숙소 유형 -->
        <td th:text="${residence.residType}"></td>
        <!-- 원가 (전체 가격) -->
        <td th:text="${residence.totalPrice}"></td>
        <td th:text="${residence.discountRate}"></td>  <!-- 할인율 -->
        <td th:text="${residence.discountedPrice}"></td>  <!-- 할인된 가격 -->
        <td th:text="${#dates.format(residence.checkinDate, 'yyyy-MM-dd')}"></td>  <!-- 체크인 날짜 -->
        <td th:text="${#dates.format(residence.checkoutDate, 'yyyy-MM-dd')}"></td>  <!-- 체크아웃 날짜 -->
        <!-- 등록일 -->
        <td th:text="${#dates.format(residence.residDate, 'yyyy-MM-dd')}"></td>
      </tr>
      </tbody>
    </table>


    <!-- 페이지 네비게이션 -->
    <!--<div th:if="${pageCount > 1}">
      <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
          <li class="page-item" th:if="${currentPage > 1}">
            <a class="page-link" th:href="@{/residence/list?pageNum=${currentPage - 1}}">&lt;</a>
          </li>
          <li class="page-item" th:each="i : ${#numbers.sequence(1, pageCount)}" th:classappend="${i == currentPage} ? ' active' : ''">
            <a class="page-link" th:href="@{/residence/list?pageNum=${i}}" th:text="${i}"></a>
          </li>
          <li class="page-item" th:if="${currentPage < pageCount}">
            <a class="page-link" th:href="@{/residence/list?pageNum=${currentPage + 1}}">&gt;</a>
          </li>
        </ul>
      </nav>
    </div>-->

  </div>
</th:block>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>
</body>
</html>