<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/layouts/main_layout}">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <meta charset="UTF-8">
    <title>숙소 사장님 페이지</title>
    <style>
        .table img {
            max-width: 100px;
            height: auto;
        }

        .container {
            background-image: url("/images/다운로드.jpg");
            background-repeat: no-repeat;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
<th:block layout:fragment="content">
    <div class="container">
        <h1 class="my-4 text-center">숙소 사장님 페이지 ^_^</h1>
        <!-- 검색 폼 -->
        <form action="#" th:action="@{/list}" method="get" class="row mb-3">
            <div class="col-md-3">
                <select name="type" class="form-control">
                    <option value="">숙소 유형 선택</option>
                    <option value="resort">리조트</option>
                    <option value="hotel">호텔</option>
                    <option value="pension">펜션</option>
                    <option value="motel">모텔</option>
                </select>
            </div>
            <div class="col-md-3">
                <input type="text" name="keyword" class="form-control" placeholder="검색어를 입력하세요"/>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary">검색</button>
            </div>
        </form>
        <!-- 숙소 등록 버튼 -->
        <div class="mb-3 text-end">
            <a th:href="@{/new}" class="btn btn-success">숙소 등록</a>
        </div>

        <!-- 숙소 목록 테이블 -->
        <table class="table table-bordered table-hover table-responsive">
            <thead class="table-dark">
            <tr>
                <th>번호</th>
                <th>숙소 사진</th>
                <th>숙소 이름</th>
                <th>숙소 유형</th>
                <th>등록일</th>
                <th>방 관리</th>
                <th>숙소 관리</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="residence : ${residences}">
                <td th:text="${residence.residNo}"></td>
                <td>
                    <th:block th:if="${residence.propertyPhotos !=
                        null and not #lists.isEmpty(residence.propertyPhotos)}">
                        <img th:src="@{|/images/files/${residence.propertyPhotos[0].thumbnailUrls}|}"
                             alt="숙소 사진" class="img-fluid"/>
                    </th:block>
                    <th:block th:unless="${residence.propertyPhotos !=
                        null and not #lists.isEmpty(residence.propertyPhotos)}">
                        사진 없음
                    </th:block>
                </td>
                <!-- 숙소 이름을 클릭하면 상세보기로 이동 -->
                <td>
                    <a class="text-decoration-none text-black"
                       th:href="@{/detail/{residNo}(residNo=${residence.residNo})}"
                       th:text="${residence.residName}"></a>
                </td>
                <td th:text="${residence.residType}"></td>
                <td th:text="${#dates.format(residence.residDate, 'yyyy-MM-dd')}"></td>
                <td>
                    <!--<a th:href="@{/room/{id}(id=${residence.residNo})/addRoom}" class="btn btn-primary">방 추가</a>
                    <a th:href="@{/edit/{id}(id=${residence.residNo})/room}" class="btn btn-warning">방 수정</a>
                    <form th:action="@{/delete/{residNo}(residNo=${residence.residNo})/room}" method="post" style="display:inline-block;">-->
                    <!-- 방 추가 -->
                    <a th:href="@{/room/{id}/addRoom(id=${residence.residNo})}" class="btn btn-primary">방 추가</a>

                    <!-- 방 수정 -->
                    <a th:href="@{/edit/{id}/room(id=${residence.residNo})}" class="btn btn-warning">방 수정</a>

                    <!-- 방 삭제 -->
                    <form th:action="@{/delete/{id}/room(id=${residence.residNo})}" method="post" style="display:inline-block;">
                        <!-- 삭제 버튼 -->
                    <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('정말 삭제하시겠습니까?');">
                            방 삭제
                        </button>
                    </form>
                </td>
                <td>
                    <a th:href="@{/edit/{id}(id=${residence.residNo})}" class="btn btn-warning btn-sm">수정</a>
                    <!-- 삭제는 POST로 처리되어야 하므로 form으로 변경 -->
                    <form th:action="@{/delete/{id}(id=${residence.residNo})}" method="post" style="display:inline-block;">
                        <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('정말 삭제하시겠습니까?');">
                            삭제
                        </button>
                    </form>
                    <!-- soldOut 숨김폼 -->
                    <!--<form th:action="@{sold_out/{residNo}(residNo=${residence.hostNo})}" method="post">
                      <button type="button" class="btn btn-secondary btn-sm">숨김</button>
                    </form>-->
                </td>
            </tr>
            <th:block th:if="${#lists.isEmpty(residences)}">
                <tr>
                    <td colspan="11" class="text-center">등록된 숙소가 없습니다.</td>
                </tr>
            </th:block>
            </tbody>
        </table><!-- 숙소 목록 테이블 END -->

        <!-- Host 페이지에 필요한 다른 기능 추가 예정 -->
        <!-- 일별 매출 조회 -->

        <!-- 월별 매출 조회 -->

        <!-- 공실 조회 -->

        <!-- 기타 등등 -->

    </div> <!-- containel END-->
</th:block>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>
</body>
</html>
